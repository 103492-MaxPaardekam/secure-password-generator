<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      http-equiv="Content-Security-Policy"
      content="default-src 'self'; script-src 'self'; style-src 'self'; object-src 'none'; base-uri 'none'; frame-ancestors 'none'; form-action 'none'"
    />
    <title>Keysmith — Secure Password & Passphrase Generator</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <main class="app">
      <header class="header">
        <h1 class="logo">Keysmith</h1>
        <p class="tagline">
          Secure passwords and passphrases—generated locally.
        </p>
      </header>

      <section class="card" aria-labelledby="generator-title">
        <h2 id="generator-title" class="visually-hidden">Password Generator</h2>

        <!-- Mode Toggle -->
        <div class="mode-toggle" role="tablist" aria-label="Generator mode">
          <button
            role="tab"
            id="tab-password"
            aria-selected="true"
            aria-controls="panel-password"
            class="mode-btn active"
            data-mode="password"
          >
            Password
          </button>
          <button
            role="tab"
            id="tab-passphrase"
            aria-selected="false"
            aria-controls="panel-passphrase"
            class="mode-btn"
            data-mode="passphrase"
          >
            Passphrase
          </button>
          <div class="mode-indicator" aria-hidden="true"></div>
        </div>

        <!-- Output Area -->
        <div class="output-section">
          <div
            class="output-container"
            role="button"
            tabindex="0"
            aria-label="Generated password. Click to copy."
            id="output-container"
          >
            <output id="output" class="output" aria-live="polite"></output>
            <span class="copy-hint">Click to copy</span>
            <span class="copied-feedback" aria-hidden="true">Copied!</span>
          </div>
          <div class="output-actions">
            <button
              type="button"
              class="btn-regenerate"
              id="btn-regenerate"
              aria-label="Generate new password (Ctrl+Enter or Cmd+Enter)"
            >
              <svg
                class="icon-refresh"
                viewBox="0 0 24 24"
                width="18"
                height="18"
                aria-hidden="true"
              >
                <path
                  d="M17.65 6.35A7.958 7.958 0 0012 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08A5.99 5.99 0 0112 18c-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"
                />
              </svg>
              Regenerate
            </button>
            <span class="shortcut-hint" aria-hidden="true">⌘/Ctrl + Enter</span>
          </div>
        </div>

        <!-- Live region for screen reader announcements -->
        <div
          id="live-region"
          class="visually-hidden"
          aria-live="polite"
          aria-atomic="true"
        ></div>

        <!-- Error display -->
        <div
          id="error-display"
          class="error-display"
          role="alert"
          aria-live="assertive"
          hidden
        ></div>

        <!-- Password Controls -->
        <div
          role="tabpanel"
          id="panel-password"
          aria-labelledby="tab-password"
          class="controls-panel"
        >
          <fieldset class="control-group">
            <legend>Length</legend>
            <div class="slider-group">
              <input
                type="range"
                id="password-length-slider"
                min="8"
                max="128"
                value="16"
                aria-label="Password length slider"
              />
              <input
                type="number"
                id="password-length-input"
                min="8"
                max="128"
                value="16"
                aria-label="Password length"
                class="length-input"
              />
            </div>
          </fieldset>

          <fieldset class="control-group">
            <legend>Character Types</legend>
            <div class="toggle-grid">
              <label class="toggle-item">
                <input type="checkbox" id="opt-lowercase" checked />
                <span class="toggle-switch"></span>
                <span class="toggle-label">Lowercase (a-z)</span>
              </label>
              <label class="toggle-item">
                <input type="checkbox" id="opt-uppercase" checked />
                <span class="toggle-switch"></span>
                <span class="toggle-label">Uppercase (A-Z)</span>
              </label>
              <label class="toggle-item">
                <input type="checkbox" id="opt-digits" checked />
                <span class="toggle-switch"></span>
                <span class="toggle-label">Digits (0-9)</span>
              </label>
              <label class="toggle-item">
                <input type="checkbox" id="opt-symbols" />
                <span class="toggle-switch"></span>
                <span class="toggle-label">Symbols</span>
              </label>
            </div>
          </fieldset>

          <fieldset
            class="control-group symbols-config"
            id="symbols-config"
            hidden
          >
            <legend>Allowed Symbols</legend>
            <input
              type="text"
              id="symbols-input"
              class="text-input"
              value="!@#$%^&*()-_=+[]{};:,.<>?"
              aria-describedby="symbols-help"
            />
            <small id="symbols-help" class="help-text"
              >Tip: remove characters you don't want included.</small
            >
          </fieldset>

          <fieldset class="control-group">
            <legend>Options</legend>
            <label class="toggle-item">
              <input type="checkbox" id="opt-ambiguous" checked />
              <span class="toggle-switch"></span>
              <span class="toggle-label">Avoid ambiguous characters</span>
            </label>
            <small class="help-text">Excludes: O, 0, I, l, 1, |, etc.</small>
          </fieldset>
        </div>

        <!-- Passphrase Controls -->
        <div
          role="tabpanel"
          id="panel-passphrase"
          aria-labelledby="tab-passphrase"
          class="controls-panel"
          hidden
        >
          <fieldset class="control-group">
            <legend>Number of Words</legend>
            <div class="slider-group">
              <input
                type="range"
                id="passphrase-words-slider"
                min="3"
                max="10"
                value="4"
                aria-label="Number of words slider"
              />
              <input
                type="number"
                id="passphrase-words-input"
                min="3"
                max="10"
                value="4"
                aria-label="Number of words"
                class="length-input"
              />
            </div>
          </fieldset>

          <fieldset class="control-group">
            <legend>Separator</legend>
            <div class="separator-controls">
              <select
                id="separator-select"
                class="select-input"
                aria-label="Word separator"
              >
                <option value="-" selected>Hyphen (-)</option>
                <option value=" ">Space</option>
                <option value="_">Underscore (_)</option>
                <option value=".">Dot (.)</option>
                <option value="custom">Custom...</option>
              </select>
              <input
                type="text"
                id="custom-separator"
                class="text-input separator-input"
                maxlength="3"
                placeholder="e.g. ~"
                aria-label="Custom separator"
                hidden
              />
            </div>
          </fieldset>

          <fieldset class="control-group">
            <legend>Capitalization</legend>
            <select
              id="capitalization-select"
              class="select-input"
              aria-label="Word capitalization"
            >
              <option value="lowercase" selected>lowercase</option>
              <option value="capitalize">Capitalize Each Word</option>
              <option value="random">rAnDoM cAsE</option>
            </select>
          </fieldset>

          <fieldset class="control-group">
            <legend>Optional Additions</legend>
            <div class="toggle-grid">
              <label class="toggle-item">
                <input type="checkbox" id="opt-add-number" />
                <span class="toggle-switch"></span>
                <span class="toggle-label">Add a number (2-3 digits)</span>
              </label>
              <label class="toggle-item">
                <input type="checkbox" id="opt-add-symbol" />
                <span class="toggle-switch"></span>
                <span class="toggle-label">Add a symbol</span>
              </label>
            </div>
          </fieldset>

          <fieldset
            class="control-group passphrase-symbols-config"
            id="passphrase-symbols-config"
            hidden
          >
            <legend>Symbol to Add From</legend>
            <input
              type="text"
              id="passphrase-symbols-input"
              class="text-input"
              value="!@#$%^&*"
              aria-describedby="passphrase-symbols-help"
            />
            <small id="passphrase-symbols-help" class="help-text"
              >One random symbol from this set will be appended.</small
            >
          </fieldset>
        </div>

        <!-- Strength Panel -->
        <section class="strength-panel" aria-labelledby="strength-title">
          <h3 id="strength-title" class="strength-title">Strength</h3>
          <div class="strength-display">
            <div class="strength-meter">
              <div class="strength-bar" id="strength-bar"></div>
            </div>
            <div class="strength-info">
              <span class="strength-label" id="strength-label">Strong</span>
              <span class="strength-bits" id="strength-bits">77.5 bits</span>
            </div>
          </div>
          <details class="strength-details">
            <summary>What this means</summary>
            <div class="details-content">
              <p>
                <strong>Entropy</strong> estimates how hard a password is to
                guess via brute force. Higher is better.
              </p>
              <ul>
                <li><strong>&lt;50 bits:</strong> Weak — easily cracked</li>
                <li>
                  <strong>50–80 bits:</strong> Okay — fine for low-value
                  accounts
                </li>
                <li>
                  <strong>80–110 bits:</strong> Strong — good for most uses
                </li>
                <li>
                  <strong>&gt;110 bits:</strong> Very Strong — excellent
                  security
                </li>
              </ul>
              <p>
                <em>Remember:</em> Password reuse is the biggest risk. Use a
                password manager and never reuse passwords.
              </p>
            </div>
          </details>
        </section>
      </section>

      <footer class="footer">
        <p class="trust-note">
          No network, no storage, no tracking. Randomness via Web Crypto.
        </p>
      </footer>
    </main>

    <script src="script.js"></script>
  </body>
</html>
